========== index.html ==========

<!DOCTYPE html>
<html>
<head>
  <title>VIP Investment</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f4f4f4; }
    .package {
      background: white; padding: 10px; margin: 10px 0; border-radius: 8px;
      box-shadow: 0 0 5px #ccc;
    }
    .package button {
      background: green; color: white; border: none;
      padding: 5px 10px; margin-top: 5px; border-radius: 4px;
    }
    .status { margin-top: 5px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>VIP Packages</h2>
  <div id="vip-packages"></div>

  <script>
    const user = { name: "Parvez", phone: "017XXXXXXXX" };

    function loadPackages() {
      const container = document.getElementById("vip-packages");
      for (let i = 1; i <= 5; i++) {
        const price = 200 + (i - 1) * 100;
        const div = document.createElement("div");
        div.className = "package";
        div.innerHTML = `
          <b>Package ${i}</b><br>
          Price: ${price} BDT<br>
          <button onclick="buyPackage(${price}, ${i})">Buy</button>
          <div class="status" id="status_${i}">Pending</div>
        `;
        container.appendChild(div);
      }
    }

    function buyPackage(price, pkgNum) {
      fetch('/buy-package', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: user.name,
          phone: user.phone,
          amount: price,
          packageNumber: pkgNum
        })
      }).then(() => {
        alert('Request sent!');
        checkStatus(user.phone, pkgNum);
      });
    }

    function checkStatus(phone, pkgNum) {
      const div = document.getElementById(`status_${pkgNum}`);
      const interval = setInterval(() => {
        fetch(`/status/${phone}/${pkgNum}`)
          .then(res => res.json())
          .then(data => {
            if (data.status === 'approved') {
              div.innerText = 'âœ… Approved';
              div.style.color = 'green';
              clearInterval(interval);
            } else if (data.status === 'reject') {
              div.innerText = 'âŒ Rejected';
              div.style.color = 'red';
              clearInterval(interval);
            }
          });
      }, 5000);
    }

    loadPackages();
  </script>
</body>
</html>


========== firebase.js ==========

const admin = require("firebase-admin");
const serviceAccount = require("./firebase/investment-app-44dcb-firebase-adminsdk-fbsvc-24165b7d05.json");

admin.initializeApp({
  credential: admin.credential.cert(serviceAccount)
});

const db = admin.firestore();
module.exports = db;


========== server.js ==========

const express = require('express');
const bodyParser = require('body-parser');
const db = require('./firebase');
const axios = require('axios');
const fs = require('fs');
const app = express();
const PORT = process.env.PORT || 3000;

const TELEGRAM_TOKEN = '7430982435:AAEWnrZZlKM7QbR__YdjnCePJCSu0ASHprI';
const CHAT_ID = '6105596008';
const TELEGRAM_API = `https://api.telegram.org/bot${TELEGRAM_TOKEN}`;

app.use(bodyParser.json());
app.use(express.static('public'));

app.post('/buy-package', async (req, res) => {
  const { username, phone, amount, packageNumber } = req.body;
  const docId = `${phone}_${packageNumber}`;
  const message = `VIP Package Request\nName: ${username}\nPhone: ${phone}\nPackage ${packageNumber} - Price: ${amount} BDT`;

  await db.collection('vipPackages').doc(docId).set({
    username, phone, amount, packageNumber,
    status: 'pending', createdAt: new Date()
  });

  await axios.post(`${TELEGRAM_API}/sendMessage`, {
    chat_id: CHAT_ID,
    text: message,
    reply_markup: {
      inline_keyboard: [[
        { text: 'Approve', callback_data: `approve_${docId}` },
        { text: 'Reject', callback_data: `reject_${docId}` }
      ]]
    }
  });

  res.send({ success: true });
});

app.post('/webhook', async (req, res) => {
  const callback = req.body.callback_query;
  if (!callback) return res.sendStatus(400);

  const [action, docId] = callback.data.split('_');

  if (action === 'approve' || action === 'reject') {
    await db.collection('vipPackages').doc(docId).update({ status: action });
    fs.writeFileSync(`./public/status-${docId}.json`, JSON.stringify({ status: action }));

    await axios.post(`${TELEGRAM_API}/sendMessage`, {
      chat_id: CHAT_ID,
      text: `${action === 'approve' ? 'âœ… Approved' : 'âŒ Rejected'} for ${docId}`
    });

    await axios.post(`${TELEGRAM_API}/answerCallbackQuery`, {
      callback_query_id: callback.id,
      text: `Marked as ${action}`
    });
  }

  res.sendStatus(200);
});

app.get('/status/:phone/:pkg', (req, res) => {
  const docId = `${req.params.phone}_${req.params.pkg}`;
  const file = `./public/status-${docId}.json`;
  if (fs.existsSync(file)) {
    const data = fs.readFileSync(file);
    res.send(JSON.parse(data));
  } else {
    res.send({ status: 'pending' });
  }
});

app.listen(PORT, () => {
  console.log(`Server running at http://localhost:${PORT}`);
});
