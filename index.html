<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login & Sign Up</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f6f9;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .login-wrapper {
      width: 100%;
      max-width: 400px;
      text-align: center;
    }
    .form-box {
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    h2 {
      color: #333;
      margin-bottom: 20px;
      font-size: 22px;
    }
    .input-group {
      margin-bottom: 15px;
      text-align: left;
    }
    .input-group label {
      display: block;
      color: #555;
      font-size: 14px;
      margin-bottom: 5px;
    }
    .input-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
    }
    .btn {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    .btn:hover {
      opacity: 0.9;
    }
    .toggle-btn {
      background: #ff5722;
      margin-top: 10px;
    }
    .toggle-btn:hover {
      background: #e64a19;
    }
    .hidden {
      display: none;
    }
    #logout-btn {
      background-color: #dc3545;
    }
    #logout-btn:hover {
      background-color: #c82333;
    }
    .balance-container {
      background: linear-gradient(45deg, #f0c27b, #4b1248, #f0a202, #7f7fd5);
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .balance-container p {
      font-size: 18px;
      font-weight: bold;
    }
    .button-container {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .action-btn {
      flex: 1 1 calc(33.33% - 10px);
      padding: 12px;
      border-radius: 6px;
      color: white;
      margin: 5px;
      cursor: pointer;
    }
    .action-btn#income-btn {
      background-color: #007bff;
    }
    .action-btn#income-btn:hover {
      background-color: #0056b3;
    }
    .action-btn#withdraw-btn {
      background-color: #28a745;
    }
    .action-btn#withdraw-btn:hover {
      background-color: #218838;
    }
    .action-btn#support-btn {
      background-color: #ffc107;
    }
    .action-btn#support-btn:hover {
      background-color: #e0a800;
    }
    .action-btn#refer-btn {
      background-color: #6f42c1;
    }
    .action-btn#refer-btn:hover {
      background-color: #5a2c8a;
    }
    .action-btn#deposit-btn {
      background-color: #17a2b8;
    }
    .action-btn#deposit-btn:hover {
      background-color: #117a8b;
    }
    .withdrawal-box {
      display: none;
      padding: 20px;
      background: #fff;
      border-radius: 6px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .withdrawal-box input {
      margin-bottom: 10px;
    }
    .submit-btn {
      background-color: #007bff;
    }
    .submit-btn:hover {
      background-color: #0056b3;
    }
    .cancel-btn {
      background-color: #ffc107;
    }
    .cancel-btn:hover {
      background-color: #e0a800;
    }
    .ad-banner {
      width: 320px;
      height: 50px;
      margin-bottom: 20px;
    }

    /* ডিপোজিট উইন্ডো */
    .deposit-box {
      display: none;
      padding: 20px;
      background: #fff;
      border-radius: 6px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-top: 20px;
    }
    .deposit-box h3 {
      margin-bottom: 10px;
      font-size: 20px;
    }
    /* সাতটি VIP বোতাম */
    .vip-btn {
      display: block;
      width: 100%;
      margin: 5px 0;
      padding: 10px;
      border-radius: 4px;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
    }
    .vip-1 { background-color: #f44336; } /* লাল */
    .vip-2 { background-color: #e91e63; } /* গোলাপি */
    .vip-3 { background-color: #9c27b0; } /* পার্পল */
    .vip-4 { background-color: #2196f3; } /* নীল */
    .vip-5 { background-color: #009688; } /* টিল */
    .vip-6 { background-color: #ff5722; } /* কমলা */
    .vip-7 { background-color: #795548; } /* ব্রাউন */

    /* পপ-আপ (একটিমাত্র) */
    #depositPopup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      width: 90%;
      max-width: 350px;
      z-index: 999;
    }
    #depositPopup h3 {
      margin-bottom: 10px;
      font-size: 20px;
      text-align: center;
    }
    .payment-methods {
      margin-bottom: 10px;
      text-align: left;
    }
    .payment-methods label {
      display: block;
      margin-bottom: 5px;
      cursor: pointer;
    }
    .popup-input {
      margin-bottom: 10px;
    }
    .popup-input input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .popup-buttons {
      display: flex;
      justify-content: space-between;
    }
    .popup-buttons button {
      flex: 1;
      margin: 5px;
      border-radius: 4px;
    }
    .popup-close {
      background-color: #dc3545;
    }
    .popup-close:hover {
      background-color: #c82333;
    }
  </style>
</head>
<body>

  <div class="login-wrapper">
    <!-- Login Form -->
    <div class="form-box" id="login-box">
      <h2>Sign In</h2>
      <form id="login-form">
        <div class="input-group">
          <label for="login-mobile">মোবাইল নম্বর</label>
          <input type="text" id="login-mobile" placeholder="আপনার মোবাইল নম্বর দিন" required />
        </div>
        <div class="input-group">
          <label for="login-password">পাসওয়ার্ড</label>
          <input type="password" id="login-password" placeholder="পাসওয়ার্ড দিন" required />
        </div>
        <button type="submit" class="btn">লগইন</button>
        <button type="button" class="btn toggle-btn" id="signup-btn">সাইন আপ</button>
      </form>
    </div>

    <!-- Sign Up Form -->
    <div class="form-box hidden" id="signup-box">
      <h2>Sign Up</h2>
      <form id="signup-form">
        <div class="input-group">
          <label for="mobile">মোবাইল নম্বর</label>
          <input type="text" id="mobile" placeholder="আপনার মোবাইল নম্বর দিন" required />
        </div>
        <div class="input-group">
          <label for="new-password">পাসওয়ার্ড</label>
          <input type="password" id="new-password" placeholder="পাসওয়ার্ড তৈরি করুন" required />
        </div>
        <button type="submit" class="btn">সাইন আপ</button>
      </form>
    </div>

    <!-- Home Page -->
    <div class="form-box hidden" id="home-box">
      <!-- Ad Banner -->
      <div class="ad-banner">
        <script type="text/javascript">
          atOptions = {
            'key' : 'b2c942281be1a851eee3a1d814b4283a',
            'format' : 'iframe',
            'height' : 50,
            'width' : 320,
            'params' : {}
          };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/b2c942281be1a851eee3a1d814b4283a/invoke.js"></script>
      </div>

      <h2>ড্যাশবোর্ড</h2>
      <p id="user-mobile"></p>
      <div class="balance-container">
        <p id="user-balance">ব্যালেন্স: 0 BDT</p>
      </div>

      <!-- Action Buttons -->
      <div class="button-container">
        <button id="income-btn" class="action-btn">ইনকাম করুন</button>
        <button id="withdraw-btn" class="action-btn">টাকা উত্তলন</button>
        <button id="support-btn" class="action-btn">সাপোর্ট গ্রুপ</button>
        <button id="refer-btn" class="action-btn">রেফার করুন</button>
        <button id="deposit-btn" class="action-btn">ডিপোজিট নাও</button>
      </div>

      <!-- Withdrawal Box -->
      <div class="withdrawal-box" id="withdrawal-box">
        <div class="input-group">
          <label for="withdraw-mobile">আপনার মোবাইল নাম্বার লিখুন</label>
          <input type="text" id="withdraw-mobile" placeholder="মোবাইল নাম্বার" required />
        </div>
        <div class="input-group">
          <label for="withdraw-amount">টাকার পরিমাণ লিখুন</label>
          <input type="number" id="withdraw-amount" placeholder="টাকার পরিমাণ" required />
        </div>
        <button type="button" class="btn submit-btn" id="submit-withdraw">সাবমিট</button>
        <button type="button" class="btn cancel-btn" id="cancel-withdraw">ক্যানসিল</button>
      </div>

      <!-- Deposit Box (VIP Options) -->
      <div class="deposit-box" id="deposit-box">
        <h3>ডিপোজিট অপশন</h3>
        <p>সাতটি ভিআইপি অপশন থেকে একটি নির্বাচন করুন:</p>
        <button class="vip-btn vip-1" data-amount="100">VIP 1 (100 BDT)</button>
        <button class="vip-btn vip-2" data-amount="200">VIP 2 (200 BDT)</button>
        <button class="vip-btn vip-3" data-amount="300">VIP 3 (300 BDT)</button>
        <button class="vip-btn vip-4" data-amount="400">VIP 4 (400 BDT)</button>
        <button class="vip-btn vip-5" data-amount="500">VIP 5 (500 BDT)</button>
        <button class="vip-btn vip-6" data-amount="600">VIP 6 (600 BDT)</button>
        <button class="vip-btn vip-7" data-amount="700">VIP 7 (700 BDT)</button>

        <button class="btn cancel-btn" id="cancel-deposit">বাতিল</button>
      </div>

      <button id="logout-btn" class="btn">লগ আউট</button>
    </div>
  </div>

  <!-- একটিমাত্র পপ-আপ, যেখানে পেমেন্ট মেথড ও তথ্য ইনপুট করা যাবে -->
  <div id="depositPopup">
    <h3>পেমেন্ট তথ্য</h3>
    <div class="payment-methods">
      <label>
        <input type="radio" name="paymentMethod" value="bKash" /> bKash
      </label>
      <label>
        <input type="radio" name="paymentMethod" value="Nagad" /> Nagad
      </label>
      <label>
        <input type="radio" name="paymentMethod" value="Rocket" /> Rocket
      </label>
      <label>
        <input type="radio" name="paymentMethod" value="Upay" /> Upay
      </label>
    </div>
    <div class="popup-input">
      <label for="deposit-phone">মোবাইল নম্বর</label>
      <input type="text" id="deposit-phone" placeholder="মোবাইল নম্বর" />
    </div>
    <div class="popup-input">
      <label for="deposit-txid">ট্রানজেকশন আইডি</label>
      <input type="text" id="deposit-txid" placeholder="ট্রানজেকশন আইডি" />
    </div>
    <div class="popup-input">
      <label for="deposit-amount">ডিপোজিট পরিমাণ</label>
      <input type="number" id="deposit-amount" readonly />
    </div>
    <div class="popup-buttons">
      <button class="btn submit-btn" id="confirmDeposit">সাবমিট</button>
      <button class="btn popup-close" id="closePopup">বন্ধ</button>
    </div>
  </div>

  <script>
    //========= Global Functions & Variables =========
    function showHomePage() {
      document.getElementById("login-box").classList.add("hidden");
      document.getElementById("signup-box").classList.add("hidden");
      document.getElementById("home-box").classList.remove("hidden");

      let storedMobile = localStorage.getItem("userMobile");
      let storedBalance = localStorage.getItem("userBalance") || 0;

      document.getElementById("user-mobile").innerText = "মোবাইল: " + storedMobile;
      document.getElementById("user-balance").innerText =
        "ব্যালেন্স: " + storedBalance + " BDT";
    }

    // প্রতিবার পেজ লোড হলে জমা করা ডিপোজিট থেকে কমিশন যোগ করার চেষ্টা
    function checkDailyCommission() {
      let depositsData = JSON.parse(localStorage.getItem("deposits") || "[]");
      let currentBalance = parseFloat(localStorage.getItem("userBalance") || 0);
      let now = Date.now();

      // প্রতিটি ডিপোজিটে ৩০ দিন পর্যন্ত প্রতিদিন ১২% কমিশন
      depositsData.forEach((dep) => {
        if (dep.daysPaid < 30) {
          // আজকের তারিখ বের করে আগের CommissionTime থেকে কতোদিন পার হয়েছে যাচাই
          let dayInMs = 24 * 60 * 60 * 1000; // ১ দিন
          while (dep.daysPaid < 30 && now >= dep.nextCommissionTime) {
            // ১২% কমিশন যোগ
            let commission = dep.depositAmount * 0.12;
            currentBalance += commission;

            // daysPaid ১ দিন বাড়িয়ে nextCommissionTime +১ দিন সেট
            dep.daysPaid++;
            dep.nextCommissionTime += dayInMs;
          }
        }
      });

      localStorage.setItem("userBalance", currentBalance);
      document.getElementById("user-balance").innerText =
        "ব্যালেন্স: " + currentBalance + " BDT";
      localStorage.setItem("deposits", JSON.stringify(depositsData));
    }

    //========= Toggle Between Login & Signup =========
    document.getElementById("signup-btn").addEventListener("click", function () {
      document.getElementById("login-box").classList.add("hidden");
      document.getElementById("signup-box").classList.remove("hidden");
    });

    //========= Sign Up Form Submission =========
    document
      .getElementById("signup-form")
      .addEventListener("submit", function (event) {
        event.preventDefault();
        let mobile = document.getElementById("mobile").value;
        let password = document.getElementById("new-password").value;

        localStorage.setItem("userMobile", mobile);
        localStorage.setItem("userPassword", password);
        localStorage.setItem("userBalance", 0); // Initial balance set to 0
        localStorage.setItem("deposits", JSON.stringify([])); // ডিপোজিট লিস্ট

        showHomePage();
      });

    //========= Login Form Submission =========
    document
      .getElementById("login-form")
      .addEventListener("submit", function (event) {
        event.preventDefault();

        let loginMobile = document.getElementById("login-mobile").value;
        let loginPassword = document.getElementById("login-password").value;

        let storedMobile = localStorage.getItem("userMobile");
        let storedPassword = localStorage.getItem("userPassword");

        if (loginMobile === storedMobile && loginPassword === storedPassword) {
          showHomePage();
          checkDailyCommission(); // লগইন হওয়ার পর কমিশন চেক
        } else {
          alert("ভুল মোবাইল নম্বর বা পাসওয়ার্ড!");
        }
      });

    //========= Logout Button =========
    document.getElementById("logout-btn").addEventListener("click", function () {
      document.getElementById("home-box").classList.add("hidden");
      document.getElementById("login-box").classList.remove("hidden");
    });

    //========= Income Button Click =========
    document.getElementById("income-btn").addEventListener("click", function () {
      window.open(
        "https://www.profitablecpmrate.com/c7gf3hhv?key=6e230d822c56accf1662d101e2443189",
        "_blank"
      ); // Direct Link Open
      setTimeout(function () {
        let currentBalance = parseFloat(localStorage.getItem("userBalance") || 0);
        currentBalance += 1; // Add 1 to balance after viewing the ad
        localStorage.setItem("userBalance", currentBalance);
        document.getElementById("user-balance").innerText =
          "ব্যালেন্স: " + currentBalance + " BDT";
      }, 5000); // Simulate viewing ad for 5 seconds
    });

    //========= Withdrawal =========
    document
      .getElementById("withdraw-btn")
      .addEventListener("click", function () {
        document.getElementById("withdrawal-box").style.display = "block";
      });
    document
      .getElementById("cancel-withdraw")
      .addEventListener("click", function () {
        document.getElementById("withdrawal-box").style.display = "none";
      });
    document
      .getElementById("submit-withdraw")
      .addEventListener("click", function () {
        let mobile = document.getElementById("withdraw-mobile").value;
        let amount = document.getElementById("withdraw-amount").value;
        let currentBalance = parseFloat(localStorage.getItem("userBalance") || 0);

        if (currentBalance < 350) {
          alert("আপনার ব্যালেন্স ৩৫০ টাকার কম, তাই টাকা উত্তলন করা যাচ্ছে না।");
        } else if (mobile && amount) {
          alert("টাকা সফলভাবে উত্তোলন হয়েছে!");
          // বাস্তব লেনদেন বা API কল এখানে যুক্ত করতে পারেন
          document.getElementById("withdrawal-box").style.display = "none";
        } else {
          alert("অনুগ্রহ করে সব তথ্য সঠিকভাবে পূর্ণ করুন।");
        }
      });

    //========= Support Button Click =========
    document
      .getElementById("support-btn")
      .addEventListener("click", function () {
        window.open("https://t.me/My_Earning20BD_bot", "_blank"); // Open Support Group
      });

    //========= Referral Button Click =========
    document
      .getElementById("refer-btn")
      .addEventListener("click", function () {
        let url = "https://20bd.netlify.app/"; // Referral Link
        if (navigator.share) {
          navigator
            .share({
              title: "Referral Link",
              text: "আমার রেফারেল লিঙ্ক:",
              url: url,
            })
            .catch(console.error);
        } else {
          alert("শেয়ার করার জন্য নিচের লিঙ্কটি কপি করুন: " + url);
        }
      });

    //========= Deposit Button Click =========
    document
      .getElementById("deposit-btn")
      .addEventListener("click", function () {
        document.getElementById("deposit-box").style.display = "block";
      });
    document
      .getElementById("cancel-deposit")
      .addEventListener("click", function () {
        document.getElementById("deposit-box").style.display = "none";
      });

    //========= VIP Buttons Click =========
    let selectedAmount = 0;
    const vipButtons = document.querySelectorAll(".vip-btn");
    vipButtons.forEach((btn) => {
      btn.addEventListener("click", function () {
        selectedAmount = parseFloat(btn.getAttribute("data-amount"));
        // পপ-আপে ডিপোজিট অ্যামাউন্ট সেট
        document.getElementById("deposit-amount").value = selectedAmount;
        // পপ-আপ দৃশ্যমান
        openDepositPopup();
      });
    });

    //========= Popup Logic =========
    const depositPopup = document.getElementById("depositPopup");
    const closePopupBtn = document.getElementById("closePopup");
    function openDepositPopup() {
      depositPopup.style.display = "block";
    }
    function closeDepositPopup() {
      depositPopup.style.display = "none";
      document.getElementById("paymentMethodReset"); // রেডিও রিসেট করতে চাইলে এখানে কোড যোগ করুন
    }
    closePopupBtn.addEventListener("click", closeDepositPopup);

    //========= Confirm Deposit =========
    document
      .getElementById("confirmDeposit")
      .addEventListener("click", function () {
        let paymentMethodEls = document.getElementsByName("paymentMethod");
        let selectedMethod = null;
        paymentMethodEls.forEach((el) => {
          if (el.checked) selectedMethod = el.value;
        });

        let phone = document.getElementById("deposit-phone").value;
        let txid = document.getElementById("deposit-txid").value;
        let amount = parseFloat(
          document.getElementById("deposit-amount").value || 0
        );

        if (!selectedMethod) {
          alert("একটি পেমেন্ট মেথড নির্বাচন করুন!");
          return;
        }
        if (!phone || !txid || !amount) {
          alert("অনুগ্রহ করে সব ঘর পূরণ করুন!");
          return;
        }

        alert(
          selectedMethod +
            " এর মাধ্যমে " +
            amount +
            " BDT পেমেন্ট প্রক্রিয়া চলছে। ৭ মিনিট পর ব্যালেন্সে যোগ হবে।"
        );

        // ৭ মিনিট পর ব্যালেন্সে যোগ করার লজিক
        setTimeout(function () {
          let currentBalance = parseFloat(
            localStorage.getItem("userBalance") || 0
          );
          currentBalance += amount;
          localStorage.setItem("userBalance", currentBalance);
          document.getElementById("user-balance").innerText =
            "ব্যালেন্স: " + currentBalance + " BDT";

          // ডিপোজিট কমিশন ব্যবস্থাপনা
          let depositsData = JSON.parse(localStorage.getItem("deposits") || "[]");
          let depositObj = {
            depositAmount: amount,
            depositTime: Date.now(),
            daysPaid: 0, // কয়দিন কমিশন পেয়েছে
            nextCommissionTime: Date.now() + 24 * 60 * 60 * 1000, // ২৪ ঘণ্টা পর প্রথম কমিশন
          };
          depositsData.push(depositObj);
          localStorage.setItem("deposits", JSON.stringify(depositsData));

          alert("ডিপোজিট সফল! প্রতিদিন ১২% করে ৩০ দিন কমিশন যোগ হবে।");
        }, 7 * 60 * 1000);

        // পপ-আপ বন্ধ করে ইনপুট রিসেট
        closeDepositPopup();
        document.getElementById("deposit-phone").value = "";
        document.getElementById("deposit-txid").value = "";
        paymentMethodEls.forEach((el) => (el.checked = false));
      });

    //========= Window Load =========
    window.addEventListener("load", function () {
      let storedMobile = localStorage.getItem("userMobile");
      let storedPassword = localStorage.getItem("userPassword");
      if (storedMobile && storedPassword) {
        showHomePage();
        checkDailyCommission();
      }
    });
  </script>
</body>
</html>
